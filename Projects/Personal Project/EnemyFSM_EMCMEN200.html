<html>
<head>
<title>EnemyFSM</title>
<style type="text/css">
<!--
/*
    This style sheet is borrowed from the NetLogo User Manual.  However, some of the units were
    changed from em to px because Java's StyleSheet support is limited for relative units such as
    em and % (this will supposively improve with newer versions of the VM) - jrn 7/21/05
    BE VERY VERY CAREFUL when you alter this style sheet -- it's possible to put in
    innocent-looking things that work on some VM's but cause Java exceptions on other for example
    we were using "font-size: 125%" but it caused Java exceptions on Java 1.5 on Windows - ST
    8/25/05
*/
:link { color: rgb(110,0,110); }
:visited { color: rgb(110,0,110); }
body {
    margin-left: 5px;
    font-family: arial, sans-serif;
    background: white;
    font-size: 12pt
}
h1 {
    color: white;
    background: rgb(45,0,45);
    font-size: 18pt;
    margin-bottom: 4px;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h2 {
    margin-top: 15px;
    margin-left: 6px;
    margin-bottom: 4px;
    background: rgb(166,172,255);
    font-size: 15pt;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h3 {
    margin-top: 15px;
    margin-left: 13px;
    margin-bottom: 4px;
    background: rgb(175,175,175);
    font-size: 12pt;
    padding: 0.2em;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h4 {
    margin-top: 15px;
    margin-bottom: 5px;
    margin-left: 15px;
    font-size: 12pt;
}
h5 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
h6 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
p {
    margin-left: 15px;
    margin-bottom: 3px;
}
pre {
    margin-left: 13px;
    background: rgb(225,225,225);
    font-family: monospace;
    font-size: 12pt;
    padding-left: 10px;
    padding-right: 3px;
    padding-top: 7px;
    padding-bottom: 7px;
    margin-top:9px;
    margin-bottom:0px;
}
code {
    font-family: monospace;
    font-size: 12pt;
}
blockquote {
    border: solid;
    border-style: solid;
    border-width: thin;
    border-color: black;
    background: rgb(250,250,220);
    padding-top: 0px;
    padding-bottom: 7px;
    margin-top: 7px;
    margin-bottom:1px;
}
ol {
   margin-bottom:1px;
}
ul {
   margin-bottom:1px;
}

-->
</style>
</head>
<body>

<p><b>NOTICE:</b> The NetLogo team no longer recommends using NetLogo applets. <a href="https://github.com/NetLogo/NetLogo/wiki/Applets">Details here</a>.</p>

<p>This page was automatically generated by NetLogo 5.1.0.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://www.java.com/">Oracle's Java site</a>.</p>

<p><hr>

<!-- <p><font size="-1">In order for this to work, this file, your model file
(EnemyFSM.nlogo), and the files NetLogoLite.jar and NetLogoLite.jar.pack.gz
must all be in the same directory.  (You can copy NetLogoLite.jar and NetLogoLite.jar.pack.gz
from the directory where you installed NetLogo.)</font></p>

<p><font size="-1">On some systems, you can test the applet locally on your computer
before uploading it to a web server.  It doesn't work on all systems,
though, so if it doesn't work from your hard drive, please try
uploading it to a web server.</font></p>

<p><font size="-1">You don't need to include everything in this file in your page.
If you want, you can just take the HTML code beginning with
&lt;applet&gt; and ending with &lt;/applet&gt;, and paste it into any HTML
file you want.  It's even OK to put multiple &lt;applet&gt; tags
on a single page.</font></p>

<p><font size="-1">If the NetLogoLite files and your model are in different
directories, you must modify the archive= and value= lines
in the HTML code to point to their actual locations.
(For example, if you have multiple applets in different
directories on the same web server, you may want to put
a single copy of the NetLogoLite files in one central place and
change the archive= lines of all the HTML files to point
to that one central copy.  This will save disk space for
you and download time for your users.)</font></p>
 -->
<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="2105" height="532">
  <param name="DefaultModel"
         value="EnemyFSM.nlogo">
  <param name="java_arguments"
         value="-Djnlp.packEnabled=true">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="EnemyFSM.nlogo">EnemyFSM.nlogo</a></p>
<h2>WHAT IS IT?</h2><h3>The Simulation</h3><p>This model demonstates the enemy&rsquo;s state switching, and the softer maze navigation for the enemy and the player.</p><h2>HOW IT WORKS</h2><h3>States</h3><p>The enemy has 4 underlying states: Wander, Seek, Catch, and Rest.</p><p>These states are entered and exited under certain conditions in the simulation.</p><h4>Wander</h4><p>The Wander state is the &ldquo;entry state&rdquo; where the enemy randomly navigates the maze.</p><h4>Seek</h4><p>The enemy transitions from Wander to the Seek state when it can see the player.</p><h4>Catch</h4><p>The enemy transitions from Seek to the Catch state when it is close to the player.</p><h4>Rest</h4><p>The enemy will finally transition to the Rest state when it is exhausted. It can enter the Rest from any other state.</p><h3>Energy</h3><h4>The Resource</h4><p>All enemies use a resource called Energy to determine state changes. </p><h4>Exhausting</h4><p>In the Seek state, it will consume energy at a basic rate. Once its energy resource drops low enough, it will become exhausted and enter the Rest state.</p><h4>Power Nap</h4><p>In the Rest state and in the Wander state, the enemy will regenerate energy. </p><h2>HOW TO USE IT</h2><h3>The Interface</h3><h4>Setting it up.</h4><p>Click Setup to initialise the simulation.</p><h4>Beginning the game.</h4><p>Clicking Move starts the simulation. The player is user controlled, and the enemy will move on its own.</p><h4>Controlling The Player</h4><p>Clicking the buttons on the right of the display window will move the player according to the button&rsquo;s display name.</p><h4>Controlling The Player (Recommended)</h4><p>Use WASD to control the player.</p><h4>Influencing The Enemy</h4><p>Using the weighting sliders will influence the direction the enemy takes at a turning point.</p><h2>THINGS TO NOTICE</h2><h3>Insight</h3><p>The enemy&rsquo;s state and energy values are displayed in monitors.</p><h2>THINGS TO TRY</h2><h3>Let Sleeping Dogs Lie</h3><p>What happens when the player touches the enemy when it is resting?</p><h3>Out For The Count</h3><p>Try to determine the energy threshold where the enemy is considered <em>exhausted</em>.</p><h3>In Control</h3><p>Adjust the sliders to see how the enemy navigates the maze with particular influence.</p><h2>EXTENDING THE MODEL</h2><h3>Seek and Destroy</h3><p>The Seek method can be expanded with a custom search algorith. The <code>canSeek</code> and <code>canCatch</code> methods will be helpful here. Can you implement a search algorithm to make the enemy find and catch the player?</p><h3>Game Over</h3><p>The Catch method is the logical lose-condition for the player. Can you implement a way to stop the game when the player is caught?</p>

<h1>CODE</h1>
<pre><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;Variables from the Pacman Level Editor.</font><font color="#000000">
</font><font color="#007f69">patches-own</font><font color="#000000"> [ pellet-grid? ] 

</font><font color="#007f69">globals</font><font color="#000000"> [
  level         </font><font color="#5a5a5a">;; current level</font><font color="#000000">
  score         </font><font color="#5a5a5a">;; your score</font><font color="#000000">
  lives         </font><font color="#5a5a5a">;; remaining lives</font><font color="#000000">
  extra-lives   </font><font color="#5a5a5a">;; total number of extra lives you've won</font><font color="#000000">
  scared        </font><font color="#5a5a5a">;; time until ghosts aren't scared (0 means not scared)</font><font color="#000000">
  level-over?   </font><font color="#5a5a5a">;; true when a level is complete</font><font color="#000000">
  dead?         </font><font color="#5a5a5a">;; true when Pac-Man is loses a life</font><font color="#000000">
  next-bonus-in </font><font color="#5a5a5a">;; time until next bonus is created</font><font color="#000000">
  tool which-ghost </font><font color="#5a5a5a">;; variables needed to properly load levels 4 and above.</font><font color="#000000">
  
  </font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  </font><font color="#000000">
  </font><font color="#5a5a5a">;;ALL THESE ABOVE GLOBALS CAN GO.  THEY'RE ONLY HERE BECAUSE THE PACMAN LEVEL EDITOR NEEDS THEM.</font><font color="#000000">

  GameStarted  </font><font color="#5a5a5a">;;Boolean indicator for the game's playing state.  When this is true, the player can move and the enemy will move.</font><font color="#000000">
]


</font><font color="#660096">breed</font><font color="#000000"> [enemies enemy ]
</font><font color="#660096">breed</font><font color="#000000"> [players player ]

</font><font color="#007f69">enemies-own</font><font color="#000000"> 
[
  state            </font><font color="#5a5a5a">;;Enemy state </font><font color="#000000">
  energy          </font><font color="#5a5a5a">;;Energy is an integer value representing the energy.</font><font color="#000000">
  isResting       </font><font color="#5a5a5a">;;isResting is a boolean flag indicating the enemy is in the regenerating part of the resting state.</font><font color="#000000">
]

</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;BASE</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup
  </font><font color="#5a5a5a">;;Initialise world</font><font color="#000000">
  </font><font color="#0000aa">clear-all</font><font color="#000000">
  </font><font color="#0000aa">import-world</font><font color="#000000"> </font><font color="#963700">&quot;Maze.csv&quot;</font><font color="#000000">
  
  </font><font color="#5a5a5a">;;Initialise variables</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> GameStarted </font><font color="#963700">false</font><font color="#000000">
  
  </font><font color="#5a5a5a">;;Create enemies</font><font color="#000000">
  create-enemies </font><font color="#963700">1</font><font color="#000000"> 
  [
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#963700">-17</font><font color="#000000"> </font><font color="#963700">-17</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> energy </font><font color="#963700">100</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> isResting </font><font color="#963700">false</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> state </font><font color="#963700">&quot;&quot;</font><font color="#000000">
  ]
  
  </font><font color="#5a5a5a">;;Create players</font><font color="#000000">
  create-players </font><font color="#963700">1</font><font color="#000000"> 
  [
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> </font><font color="#963700">-4</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">
  ]  
  
  </font><font color="#0000aa">reset-ticks</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> baseUpdate
  
  </font><font color="#0000aa">set</font><font color="#000000"> GameStarted </font><font color="#963700">true</font><font color="#000000">
  updateEnemyState
  </font><font color="#0000aa">tick</font><font color="#000000">
  </font><font color="#0000aa">wait</font><font color="#000000"> </font><font color="#963700">0.1</font><font color="#000000">
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;PLAYER</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> PlayerUp  
  
  </font><font color="#5a5a5a">;look forward. </font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> GameStarted
  [
    </font><font color="#0000aa">ask</font><font color="#000000"> players [ 
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> 
      
      </font><font color="#5a5a5a">;If that patch is black, then move onto it.</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
      [
        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ]  
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> PlayerRight
  
  </font><font color="#5a5a5a">;Turn right</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> GameStarted
  [
    </font><font color="#0000aa">ask</font><font color="#000000"> players 
    [ 
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000">
      
      </font><font color="#5a5a5a">;If that patch is black, then move onto it.</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
      [
        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ] 
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> PlayerDown
  
  </font><font color="#5a5a5a">;Look backwards</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> GameStarted
  [
    </font><font color="#0000aa">ask</font><font color="#000000"> players 
    [ 
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> 
      
      </font><font color="#5a5a5a">;If that patch is black, then move onto it.</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
      [
        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ] 
    ]
  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> PlayerLeft
  
  </font><font color="#5a5a5a">;look left</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> GameStarted
  [
    </font><font color="#0000aa">ask</font><font color="#000000"> players 
    [ 
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">270</font><font color="#000000">
      
      </font><font color="#5a5a5a">;If that patch is black, then move onto it.</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
      [
        </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      ] 
    ]
  ]
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;ENEMY STATE CONTROL METHOD</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> updateEnemyState
  </font><font color="#0000aa">ask</font><font color="#000000"> enemies
  [
    </font><font color="#5a5a5a">;;We need to check if we can act.</font><font color="#000000">
    </font><font color="#5a5a5a">;;If not, then it will need to rest.</font><font color="#000000">
    </font><font color="#0000aa">ifelse</font><font color="#000000"> canAct
    [     
      </font><font color="#5a5a5a">;;If we can act, the enemy does not need to rest.  Therefore, we set the flag appropritely here.</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> isResting </font><font color="#963700">false</font><font color="#000000">
      
      </font><font color="#0000aa">ifelse</font><font color="#000000"> canSeek
      [
        </font><font color="#5a5a5a">;;Switch to Seek state when we can act and canseek.</font><font color="#000000">
        SeekState
        
        </font><font color="#0000aa">if</font><font color="#000000"> canCatch
        [
          </font><font color="#5a5a5a">;;Switch to Catch state when we can act and can catch</font><font color="#000000">
          CatchState
        ]        
      ]
      [
        </font><font color="#5a5a5a">;;Switch to Wander state when we have more than 25 energy and cannot seek.</font><font color="#000000">
        WanderState
      ]      
    ]
    [
      </font><font color="#5a5a5a">;;Switch to Rest state when we can't act.</font><font color="#000000">
      RestState
    ]    
  ]  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;ENEMY STATE METHODS</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> WanderState
    
  </font><font color="#5a5a5a">;;Update State</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> state </font><font color="#963700">&quot;WANDER STATE&quot;</font><font color="#000000">
  
  </font><font color="#5a5a5a">;;Move forward if the enemy has energy</font><font color="#000000">
  </font><font color="#0000aa">forward</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
       
  </font><font color="#5a5a5a">;;Regenerate energy quickly</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> energy </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> energy energy </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">]
  
  </font><font color="#5a5a5a">;;If we regenerate too much energy, set energy to 100</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> energy </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> energy </font><font color="#963700">100</font><font color="#000000"> ]
  
  </font><font color="#5a5a5a">;;Declare list.</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> directions[]
  
  </font><font color="#5a5a5a">;;Turn around if local walls are blue</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-right-and-ahead</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> </font><font color="#660096">and</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-left-and-ahead</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000">
  [
    </font><font color="#0000aa">set</font><font color="#000000"> directions </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> directions
  ]
  
  </font><font color="#5a5a5a">;Otherwise do the pathing stuff.</font><font color="#000000">
  [   
    </font><font color="#5a5a5a">;;Check infront</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    [
      </font><font color="#5a5a5a">;Add a heavy weighting to the forward direction.</font><font color="#000000">
      </font><font color="#0000aa">repeat</font><font color="#000000"> EnemyForwardWeighting [ </font><font color="#0000aa">set</font><font color="#000000"> directions </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> directions ]
    ]
    
    </font><font color="#5a5a5a">;;Check to the right</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-right-and-ahead</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    [
      </font><font color="#5a5a5a">;Add a light weighting to the right direction.</font><font color="#000000">
      </font><font color="#0000aa">repeat</font><font color="#000000"> EnemyRightWeighting [ </font><font color="#0000aa">set</font><font color="#000000"> directions </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> directions ]
      
    ]
    
    </font><font color="#5a5a5a">;;Check to the left</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch-left-and-ahead</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
    [
      </font><font color="#5a5a5a">;Add a light weighting to the left direction.</font><font color="#000000">
      </font><font color="#0000aa">repeat</font><font color="#000000"> EnemyLeftWeighting [ </font><font color="#0000aa">set</font><font color="#000000"> directions </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">-90</font><font color="#000000"> directions ]
    ]    
  ]
  
  </font><font color="#5a5a5a">;;Returns a random number between 0 and the list max minus 1. </font><font color="#000000">
  </font><font color="#5a5a5a">;;For example, if only forward and right were options, the list would contain 2 elements.  0, and 1.</font><font color="#000000">
  </font><font color="#5a5a5a">;;Randomly return an index of this list to return a value, either right or forward.</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> value </font><font color="#660096">random</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> directions)
  
  </font><font color="#5a5a5a">;;Change direction</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> value directions 
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> SeekState
  
  </font><font color="#5a5a5a">;;Update State</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> state </font><font color="#963700">&quot;SEEK STATE&quot;</font><font color="#000000"> 
  
  </font><font color="#5a5a5a">;;If the enemy has energy, decrement it.</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> energy energy </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> CatchState
  
  </font><font color="#5a5a5a">;;Update State</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> state </font><font color="#963700">&quot;CATCH STATE&quot;</font><font color="#000000">
  
  </font><font color="#5a5a5a">;;Display message.</font><font color="#000000">
  </font><font color="#0000aa">user-message</font><font color="#000000"> </font><font color="#963700">&quot;Player caught!&quot;</font><font color="#000000">
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> RestState
  
  </font><font color="#5a5a5a">;;Update State</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> state </font><font color="#963700">&quot;REST STATE&quot;</font><font color="#000000">
  
  </font><font color="#5a5a5a">;;zero energy if not already resting            </font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> isResting </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
  [ 
    </font><font color="#5a5a5a">;;Zero energy and take a nap.</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> energy </font><font color="#963700">0</font><font color="#000000"> 
    
    </font><font color="#5a5a5a">;;Set resting flag</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> isResting </font><font color="#963700">true</font><font color="#000000">
  ]
  [
    </font><font color="#5a5a5a">;;Regenerate energy</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> energy energy </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  
  ]
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;ENEMY CHECK METHODS</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> canSeek
  
  </font><font color="#5a5a5a">;;Check for a player on the patches in a cone of radius 1, length 5.</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> players-on </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">in-cone</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000">
  [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">
    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">
  ]
  [  
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">
    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
  ]
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> canCatch
  
  </font><font color="#5a5a5a">;;If the player is right infront of the enemy, catch them like a fish.</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> players-on </font><font color="#660096">patch-ahead</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  [
    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">
  ]
  [
    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
  ]
    
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> canAct
  
  </font><font color="#5a5a5a">;;If the enemy has less than 25 energy, it can't do anything and must rest.</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> energy </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">25</font><font color="#000000"> 
  [
   </font><font color="#5a5a5a">;Color will be set by higher level state.</font><font color="#000000">
   </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000"> 
  ]
  [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">
    </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">
  ]
</font><font color="#007f69">end</font>
</pre>

</body>
</html>
