<html>
<head>
<title>wallAI_2</title>
<style type="text/css">
<!--
/*
    This style sheet is borrowed from the NetLogo User Manual.  However, some of the units were
    changed from em to px because Java's StyleSheet support is limited for relative units such as
    em and % (this will supposively improve with newer versions of the VM) - jrn 7/21/05
    BE VERY VERY CAREFUL when you alter this style sheet -- it's possible to put in
    innocent-looking things that work on some VM's but cause Java exceptions on other for example
    we were using "font-size: 125%" but it caused Java exceptions on Java 1.5 on Windows - ST
    8/25/05
*/
:link { color: rgb(110,0,110); }
:visited { color: rgb(110,0,110); }
body {
    margin-left: 5px;
    font-family: arial, sans-serif;
    background: white;
    font-size: 12pt
}
h1 {
    color: white;
    background: rgb(45,0,45);
    font-size: 18pt;
    margin-bottom: 4px;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h2 {
    margin-top: 15px;
    margin-left: 6px;
    margin-bottom: 4px;
    background: rgb(166,172,255);
    font-size: 15pt;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h3 {
    margin-top: 15px;
    margin-left: 13px;
    margin-bottom: 4px;
    background: rgb(175,175,175);
    font-size: 12pt;
    padding: 0.2em;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h4 {
    margin-top: 15px;
    margin-bottom: 5px;
    margin-left: 15px;
    font-size: 12pt;
}
h5 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
h6 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
p {
    margin-left: 15px;
    margin-bottom: 3px;
}
pre {
    margin-left: 13px;
    background: rgb(225,225,225);
    font-family: monospace;
    font-size: 12pt;
    padding-left: 10px;
    padding-right: 3px;
    padding-top: 7px;
    padding-bottom: 7px;
    margin-top:9px;
    margin-bottom:0px;
}
code {
    font-family: monospace;
    font-size: 12pt;
}
blockquote {
    border: solid;
    border-style: solid;
    border-width: thin;
    border-color: black;
    background: rgb(250,250,220);
    padding-top: 0px;
    padding-bottom: 7px;
    margin-top: 7px;
    margin-bottom:1px;
}
ol {
   margin-bottom:1px;
}
ul {
   margin-bottom:1px;
}

-->
</style>
</head>
<body>

<p><b>NOTICE:</b> The NetLogo team no longer recommends using NetLogo applets. <a href="https://github.com/NetLogo/NetLogo/wiki/Applets">Details here</a>.</p>

<p>This page was automatically generated by NetLogo 5.2-RC2.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://www.java.com/">Oracle's Java site</a>.</p>

<p><hr>

<p><font size="-1">In order for this to work, this file, your model file
(wallAI_2.nlogo), and the files NetLogoLite.jar and NetLogoLite.jar.pack.gz
must all be in the same directory.  (You can copy NetLogoLite.jar and NetLogoLite.jar.pack.gz
from the directory where you installed NetLogo.)</font></p>

<p><font size="-1">On some systems, you can test the applet locally on your computer
before uploading it to a web server.  It doesn't work on all systems,
though, so if it doesn't work from your hard drive, please try
uploading it to a web server.</font></p>

<p><font size="-1">You don't need to include everything in this file in your page.
If you want, you can just take the HTML code beginning with
&lt;applet&gt; and ending with &lt;/applet&gt;, and paste it into any HTML
file you want.  It's even OK to put multiple &lt;applet&gt; tags
on a single page.</font></p>

<p><font size="-1">If the NetLogoLite files and your model are in different
directories, you must modify the archive= and value= lines
in the HTML code to point to their actual locations.
(For example, if you have multiple applets in different
directories on the same web server, you may want to put
a single copy of the NetLogoLite files in one central place and
change the archive= lines of all the HTML files to point
to that one central copy.  This will save disk space for
you and download time for your users.)</font></p>

<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="1123" height="637">
  <param name="DefaultModel"
         value="wallAI_2.nlogo">
  <param name="java_arguments"
         value="-Djnlp.packEnabled=true">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="wallAI_2.nlogo">wallAI_2.nlogo</a></p>
<h2>WHAT IS IT?</h2><p>This Model emulates a basic artificial life environment, where a random map is generated and thereafter Units are formed. Then the Units try to move around the world restrained by rules.</p><h2>HOW IT WORKS</h2><p>After map-formation, individual tiles (Bricks) look around in four directions for neighbouring Bricks and try to form Units with them.<br/>Units stay together for the rest of the game.<br/>After Unit-formation a Unit gets selected randomly and its members ask to vote for moving or staying. If they vote to move, they re-vote for the direction of movement.<br/>This can be influenced.<br/>Finally the Unit moves (if the movement is possible) and another Unit is selected and the cycle starts over&hellip;</p><h2>HOW TO USE IT</h2><p>First set the Filling level with the slider.<br/>Then generate a map.<br/>Form initial Units.<br/>Press moveUnits.</p><p>Control the moving willingness with the X slider. (the bigger the X the less likely they move)<br/>Control the required direction agreement precentige with the Y slider. (the bigger the Y the less more votes needed)<br/>Control the extra vote Bricks get that wanted to move in the first place. (not implemented yet)<br/>Select the prefered moving direction from the drop-down list<br/>Control the prefrecence influence with the slider below the list.</p><p>&lsquo;Generated Units&rsquo; meter shows the number of individual Units currently on the map.<br/>&lsquo;Total Unit Moves&rsquo; shown the number of actual movements Units made so far<br/>&lsquo;Moving precentige&rsquo; shows the ratio between the total possible movements and actual movements Units made</p><h2>THINGS TO NOTICE</h2><p>Wall units stay together during the run.<br/>Wall shapes never crash into each other or push each other.<br/>If the Y slider is really high, Units take way longer to agree on a direction.<br/>Walls never vote to move to the same direction if they already found out it&rsquo;s invalid in the current iteration.</p><h2>THINGS TO TRY</h2><p>Change the moving direction / influence to see how the Bricks react to the change.</p><h2>CREDITS AND REFERENCES</h2><p>Developed by Zoltan Tompa - 2015, for the Team8 shared AI project.</p>

<h1>CODE</h1>
<pre><font color="#5a5a5a">; Author: Zoltan Tompa - 2015</font><font color="#000000">
</font><font color="#5a5a5a">;</font><font color="#000000">
</font><font color="#5a5a5a">;</font><font color="#000000">
</font><font color="#5a5a5a">; notes: </font><font color="#000000">
</font><font color="#5a5a5a">;       by default, patches get a groupID variable with the initial value of 0 !!!</font><font color="#000000">
</font><font color="#5a5a5a">;       word wrapping has to be disabled</font><font color="#000000">
</font><font color="#5a5a5a">;       wall movement doesn't takes the player or enemy's into account, can just crushes them</font><font color="#000000">
</font><font color="#5a5a5a">;       ;* notation is used for depricated code</font><font color="#000000">
</font><font color="#5a5a5a">;</font><font color="#000000">
</font><font color="#5a5a5a">;</font><font color="#000000">
</font><font color="#5a5a5a">;; BUGs::</font><font color="#000000">

</font><font color="#5a5a5a">;;TO-DOs</font><font color="#000000">

</font><font color="#5a5a5a">;;Ideas; </font><font color="#000000">

</font><font color="#5a5a5a">;- make Bricks they wanted to move initially more weighted in direction voting (use slider for ptc) than those who didn't</font><font color="#000000">
</font><font color="#5a5a5a">;- add functionality to Unit reFormation (Join/Split Units)</font><font color="#000000">
</font><font color="#5a5a5a">;/ they can &quot;prefer&quot; to join smaller/bigger/no prefference Units</font><font color="#000000">
</font><font color="#5a5a5a">;/ there will be a precentage for Join or not (one random no (on slider) for the whol Unit)</font><font color="#000000">
</font><font color="#5a5a5a">;/ Bricks vote to separate themselfs form their Units (and may join aother one if it's 1 tile away) (value on slider)</font><font color="#000000">

</font><font color="#007f69">patches-own</font><font color="#000000"> [
             patchID    </font><font color="#5a5a5a">; a simple counter for all patches to be numbered starts with 1</font><font color="#000000">
             groupID    </font><font color="#5a5a5a">; to group Units together</font><font color="#000000">
             movingWill   </font><font color="#5a5a5a">;how much the individual Bricks want to move (scale 0-10)</font><font color="#000000">
             movingDir  </font><font color="#5a5a5a">; in which of the 4 directions the unit wants to move (-1 +1 | col row)</font><font color="#000000">
             ]


</font><font color="#007f69">globals</font><font color="#000000"> [
  
   </font><font color="#5a5a5a">;X the precentige need to be met for a unit to decide to move</font><font color="#000000">
   </font><font color="#5a5a5a">;Y the precentige need to be met for a unit to decide on moving direction</font><font color="#000000">
    
  groupIdCounter         </font><font color="#5a5a5a">;to keep track of the number of units</font><font color="#000000">
  patchIDcounter         </font><font color="#5a5a5a">;to number the patches</font><font color="#000000">
  isfirtsredfound
  
  UnitIDList             </font><font color="#5a5a5a">;list of existing UnitIDs</font><font color="#000000">
  UnitMovingDir          </font><font color="#5a5a5a">;agreed direction of Unit movement</font><font color="#000000">
  validMovesList         </font><font color="#5a5a5a">;list of valid moves</font><font color="#000000">
  canUnitMove            </font><font color="#5a5a5a">;is selected Unit free to move to the agreed movement?</font><font color="#000000">
  UnitWantsMove          </font><font color="#5a5a5a">;is selected Unit wants to move at all?</font><font color="#000000">
  
  UnitMoveCounter        </font><font color="#5a5a5a">;how much move happened overall</font><font color="#000000">
  TurnCounter            </font><font color="#5a5a5a">;how much move could had happened (if 100% move)</font><font color="#000000">
  
  WorldRowCount          </font><font color="#5a5a5a">;how many rows does the world exist of (on one side)</font><font color="#000000">
  WorldColCount          </font><font color="#5a5a5a">;how many colums does the world exist of (on one side)</font><font color="#000000">

  curCol
  curRow
  
  BrickColor             </font><font color="#5a5a5a">;the color of the wall</font><font color="#000000">
  BGColor                </font><font color="#5a5a5a">;the color of the background</font><font color="#000000">

  
  
  selectedUnit  </font><font color="#5a5a5a">;the selected unit choosen to allow to move</font><font color="#000000">

         ]
</font><font color="#5a5a5a">;;;M1.2</font><font color="#000000">
</font><font color="#5a5a5a">;;a method to initialise and set up the global variables</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> init
    </font><font color="#5a5a5a">;clear the world</font><font color="#000000">
    </font><font color="#0000aa">clear-all</font><font color="#000000">
    </font><font color="#0000aa">clear-patches</font><font color="#000000"> 
    </font><font color="#0000aa">reset-ticks</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> UnitMoveCounter </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> TurnCounter </font><font color="#963700">0</font><font color="#000000">
    </font><font color="#0000aa">clear-all-plots</font><font color="#000000"> 
    </font><font color="#0000aa">clear-globals</font><font color="#000000"> 

    </font><font color="#5a5a5a">;set up PUBLIC variables</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> WorldRowCount </font><font color="#963700">16</font><font color="#000000"> </font><font color="#5a5a5a">;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> WorldColCount </font><font color="#963700">16</font><font color="#000000"> </font><font color="#5a5a5a">; the dimensions of the non-wrapping world</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> BrickColor  </font><font color="#963700">red</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> BGColor  </font><font color="#963700">blue</font><font color="#000000">

    </font><font color="#5a5a5a">;set up PRIVATE variables</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> groupIdCounter </font><font color="#963700">0</font><font color="#000000"> </font><font color="#5a5a5a">;reset the groupcounter</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> isfirtsredfound </font><font color="#963700">false</font><font color="#5a5a5a">;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> patchIDcounter </font><font color="#963700">1</font><font color="#5a5a5a">;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> curRow WorldRowCount
    
    </font><font color="#0000aa">set</font><font color="#000000"> UnitWantsMove </font><font color="#963700">false</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> validMovesList []
    

    initrow
  
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">;;;M1</font><font color="#000000">
</font><font color="#5a5a5a">;;method to generate a random map</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> genmap
  
  init
  
</font><font color="#5a5a5a">; set BG to BGColor</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> BGColor] 
  
</font><font color="#5a5a5a">;generate a random map, so I can play with it =)</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> filling_level </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> BrickColor]
  
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">;;;M2</font><font color="#000000">
</font><font color="#5a5a5a">;;method to find neighbouring bricks, and form Units with them</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> formUnits
  
  </font><font color="#5a5a5a">;; form the first row (call method)</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> curCol (</font><font color="#660096">-</font><font color="#000000"> WorldColCount </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)
  </font><font color="#0000aa">let</font><font color="#000000"> i  (</font><font color="#660096">-</font><font color="#000000"> WorldColCount)
  </font><font color="#0000aa">while</font><font color="#000000"> [ i </font><font color="#660096">&lt;</font><font color="#000000"> (WorldColCount </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)]
  [

    firstRow
    </font><font color="#0000aa">set</font><font color="#000000">  i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  ]
   
     
  </font><font color="#5a5a5a">;; form the other rows (call method)  </font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> j (</font><font color="#660096">-</font><font color="#000000"> WorldColCount)
  </font><font color="#0000aa">while</font><font color="#000000"> [ j </font><font color="#660096">&lt;</font><font color="#000000"> (WorldColCount </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)]  
  [
    </font><font color="#0000aa">set</font><font color="#000000"> i (</font><font color="#660096">-</font><font color="#000000"> WorldRowCount)
    </font><font color="#0000aa">while</font><font color="#000000"> [ i </font><font color="#660096">&lt;</font><font color="#000000"> (WorldRowCount </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)]
  [
    secRow
    </font><font color="#0000aa">set</font><font color="#000000">  i (i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)
  ]
  
  
  </font><font color="#0000aa">set</font><font color="#000000">  j (j </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)
  ]
    
</font><font color="#5a5a5a">;;call method to generate a valid groupIDlist  </font><font color="#000000">
buildUnitIDList
  
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;M2.1</font><font color="#000000">
</font><font color="#5a5a5a">;;method to form units in the first row</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> firstRow

  
  </font><font color="#0000aa">set</font><font color="#000000"> curCol curCol </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  
  
  
      </font><font color="#0000aa">if</font><font color="#000000"> curCol </font><font color="#660096">=</font><font color="#000000"> (WorldColCount </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [ initrow </font><font color="#0000aa">set</font><font color="#000000"> curRow curRow </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#0000aa">stop</font><font color="#000000"> ]


    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol curRow 
       [
         </font><font color="#5a5a5a">;number every patch for easier processing</font><font color="#000000">
         </font><font color="#0000aa">set</font><font color="#000000"> patchID patchIDcounter
         </font><font color="#0000aa">set</font><font color="#000000"> patchIDcounter patchIDcounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
         
         </font><font color="#5a5a5a">;check if patch is a Brick or not</font><font color="#000000">
         </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> BrickColor [ 
                               </font><font color="#0000aa">if</font><font color="#000000"> isfirtsredfound </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> groupID </font><font color="#963700">1</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> groupIdCounter groupIdCounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> isfirtsredfound </font><font color="#963700">true</font><font color="#000000">]
                               
                               </font><font color="#0000aa">if</font><font color="#000000"> groupID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">[ </font><font color="#0000aa">set</font><font color="#000000"> groupID groupIdCounter </font><font color="#0000aa">set</font><font color="#000000"> groupIdCounter groupIdCounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]
                               
                               </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> groupID
                               
                               </font><font color="#0000aa">if</font><font color="#000000"> curCol </font><font color="#660096">!=</font><font color="#000000"> (WorldColCount) [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (curCol </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) curRow [</font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> BrickColor [ </font><font color="#0000aa">set</font><font color="#000000"> groupID [groupID] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol curRow  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> groupID]]] </font><font color="#5a5a5a">;ask ahead but not in the last Col</font><font color="#000000">
                               </font><font color="#5a5a5a">;ask patch curCol (curRow - 1) [if pcolor = BrickColor [ set groupID [groupID] of patch curCol curRow  set plabel groupID]] ;ask below</font><font color="#000000">
                               
                              ]
         
         
         
         [  ] </font><font color="#5a5a5a">; is not a Brick    </font><font color="#000000">
        ]
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;M2.2</font><font color="#000000">
</font><font color="#5a5a5a">;;method to form Units in every additional row</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> secRow
  </font><font color="#0000aa">set</font><font color="#000000"> curCol curCol </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> curCol </font><font color="#660096">=</font><font color="#000000"> (WorldColCount </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [ initrow </font><font color="#0000aa">set</font><font color="#000000"> curRow curRow </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#0000aa">stop</font><font color="#000000"> ]
  
  </font><font color="#0000aa">let</font><font color="#000000"> rowAboveBrick  </font><font color="#963700">false</font><font color="#5a5a5a">;</font><font color="#000000">

    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol curRow 
       [
         
         </font><font color="#5a5a5a">;number every patch for easier processing</font><font color="#000000">
         </font><font color="#0000aa">set</font><font color="#000000"> patchID patchIDcounter
         </font><font color="#0000aa">set</font><font color="#000000"> patchIDcounter patchIDcounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
         
         </font><font color="#5a5a5a">;check if patch is a Brick or not</font><font color="#000000">
         </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> BrickColor [ 
                               
                               
                               </font><font color="#0000aa">ifelse</font><font color="#000000"> [groupID] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol (curRow </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> groupID [groupID] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol (curRow </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)  </font><font color="#0000aa">set</font><font color="#000000"> rowAboveBrick  </font><font color="#963700">true</font><font color="#000000">] </font><font color="#5a5a5a">;ask above</font><font color="#000000">
                               [</font><font color="#0000aa">if</font><font color="#000000"> groupID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> groupID groupIdCounter </font><font color="#0000aa">set</font><font color="#000000"> groupIdCounter groupIdCounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]]
                               </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> groupID
                               
                               
                              </font><font color="#0000aa">if</font><font color="#000000"> curCol </font><font color="#660096">!=</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> WorldColCount) [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (curCol </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) curRow [</font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> BrickColor) </font><font color="#660096">and</font><font color="#000000"> ((groupID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (rowAboveBrick </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">)) [ </font><font color="#0000aa">set</font><font color="#000000"> groupID [groupID] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol curRow </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> groupID  ]]] </font><font color="#5a5a5a">;ask behind, except in the first col</font><font color="#000000">
                              </font><font color="#0000aa">if</font><font color="#000000"> curCol </font><font color="#660096">!=</font><font color="#000000"> (WorldColCount)  [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (curCol </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) curRow [</font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> BrickColor) </font><font color="#660096">and</font><font color="#000000"> ((groupID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">or</font><font color="#000000"> (rowAboveBrick </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">)) [ </font><font color="#0000aa">set</font><font color="#000000"> groupID [groupID] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> curCol curRow </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> groupID  ]]] </font><font color="#5a5a5a">;ask ahead, except the last col</font><font color="#000000">
                               
                              ]
         
         
         
         [ ] </font><font color="#5a5a5a">; is not a Brick    </font><font color="#000000">
        ]
    
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">;;;M2.1.1</font><font color="#000000">
</font><font color="#5a5a5a">;;method to reset the col number in the end of every row</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> initrow
  
      </font><font color="#0000aa">set</font><font color="#000000"> curCol  (</font><font color="#660096">-</font><font color="#000000"> WorldRowCount </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)
  
</font><font color="#007f69">end</font><font color="#000000">




</font><font color="#5a5a5a">;;;M2.3</font><font color="#000000">
</font><font color="#5a5a5a">;; a method to build a list of valid Unit IDs</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> buildUnitIDList

</font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000">
</font><font color="#0000aa">set</font><font color="#000000"> UnitIDList []

</font><font color="#0000aa">while</font><font color="#000000"> [i </font><font color="#660096">&lt;=</font><font color="#000000"> patchIDcounter]

[

</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(patchID </font><font color="#660096">=</font><font color="#000000"> i)] [ </font><font color="#0000aa">if</font><font color="#000000"> (groupID) </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [ </font><font color="#0000aa">ifelse</font><font color="#000000">(</font><font color="#660096">member?</font><font color="#000000"> groupID UnitIDList) [] [ </font><font color="#0000aa">set</font><font color="#000000"> UnitIDList </font><font color="#660096">lput</font><font color="#000000"> groupID UnitIDList ]  ] ]
  
</font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">  
]

</font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">show</font><font color="#000000"> UnitIDList]

</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">;;;M4.1</font><font color="#000000">
</font><font color="#5a5a5a">;; method to pick a random unit</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> pickOneUnit
  
</font><font color="#5a5a5a">;from the 2nd instance, set the previously picked unit back the the BGColor</font><font color="#000000">
</font><font color="#0000aa">ifelse</font><font color="#000000"> (selectedUnit </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [][</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit] [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> BrickColor]]

  
</font><font color="#0000aa">set</font><font color="#000000"> selectedUnit  </font><font color="#660096">one-of</font><font color="#000000"> UnitIDList </font><font color="#5a5a5a">; gives a number between 1 and the number of groups</font><font color="#000000">
</font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">print</font><font color="#000000"> selectedUnit]
</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit] [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000">]

</font><font color="#0000aa">tick</font><font color="#000000">  
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;M4.2</font><font color="#000000">
</font><font color="#5a5a5a">;;method to find out if Bricks wants to move more than X or not</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> decideIfMoving
  
  </font><font color="#0000aa">let</font><font color="#000000"> AVG  </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit] [</font><font color="#0000aa">set</font><font color="#000000"> movingWill </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">11</font><font color="#000000">] </font><font color="#5a5a5a">;assign a moovingwill value to each Brick 0-10</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> AVG </font><font color="#660096">sum</font><font color="#000000"> [movingWill] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit]
  </font><font color="#0000aa">set</font><font color="#000000"> AVG AVG </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit]

  </font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">print</font><font color="#000000"> AVG]
  
  </font><font color="#0000aa">ifelse</font><font color="#000000"> (AVG </font><font color="#660096">&gt;=</font><font color="#000000"> X) [ </font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;to infinity, and beyound!!!&quot;</font><font color="#000000">] </font><font color="#0000aa">set</font><font color="#000000"> UnitWantsMove </font><font color="#963700">true</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> UnitWantsMove </font><font color="#963700">false</font><font color="#000000">] </font><font color="#5a5a5a">;check if more Bricks than X wants to move or not</font><font color="#000000">
  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;M4.3</font><font color="#000000">
</font><font color="#5a5a5a">;;method to find out which way Bricks wants to go   [0=left|1=up|2=right|3=down]</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> decideUnitMovingDirection
  
 </font><font color="#0000aa">set</font><font color="#000000"> UnitMovingDir  </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#5a5a5a">; set to an invalid value</font><font color="#000000">

 
  
 </font><font color="#0000aa">while</font><font color="#000000"> [UnitMovingDir </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">]
 [ 
  
    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit] </font><font color="#5a5a5a">;assign a moovingDir value to each Brick 0-3</font><font color="#000000">
   [
     
     </font><font color="#0000aa">if</font><font color="#000000"> (PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;none&quot;</font><font color="#000000">)[ </font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList]
     </font><font color="#0000aa">if</font><font color="#000000"> (PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;North&quot;</font><font color="#000000">)[ </font><font color="#0000aa">ifelse</font><font color="#000000"> ( (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) ) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> validMovesList)) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> (PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;South&quot;</font><font color="#000000">)[ </font><font color="#0000aa">ifelse</font><font color="#000000"> ( (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) ) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> validMovesList)) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">3</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> (PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;East&quot;</font><font color="#000000">) [ </font><font color="#0000aa">ifelse</font><font color="#000000"> ( (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) ) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> validMovesList)) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">2</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> (PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;West&quot;</font><font color="#000000">) [ </font><font color="#0000aa">ifelse</font><font color="#000000"> ( (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) ) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList)) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">0</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]


     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;North-East&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ((</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> validMovesList))) [ </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)) [</font><font color="#0000aa">ifelse</font><font color="#000000"> ( </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">2</font><font color="#000000">]] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;North-East&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ( </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000">  </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> validMovesList))) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList]

     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;North-West&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ((</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList))) [ </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)) [</font><font color="#0000aa">ifelse</font><font color="#000000"> ( </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">0</font><font color="#000000">]] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;North-West&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ( </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList))) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList]
     
     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;South-East&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ((</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> validMovesList))) [ </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)) [</font><font color="#0000aa">ifelse</font><font color="#000000"> ( </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">3</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">2</font><font color="#000000">]] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;South-East&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ( </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000">  </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> validMovesList))) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList]
     
     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;South-West&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ((</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList))) [ </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> (directionPreferenceIncluence </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">)) [</font><font color="#0000aa">ifelse</font><font color="#000000"> ( </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#963700">0</font><font color="#000000">]] [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList] ]
     </font><font color="#0000aa">if</font><font color="#000000"> ((PreferedDirection </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;South-West&quot;</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ( </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> validMovesList) </font><font color="#660096">or</font><font color="#000000">  </font><font color="#660096">not</font><font color="#000000"> (</font><font color="#660096">member?</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList))) [</font><font color="#0000aa">set</font><font color="#000000"> movingDir </font><font color="#660096">one-of</font><font color="#000000"> validMovesList]
    ]


  </font><font color="#0000aa">let</font><font color="#000000"> _left </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit) </font><font color="#660096">and</font><font color="#000000"> (movingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)]
  </font><font color="#0000aa">let</font><font color="#000000"> _up </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit) </font><font color="#660096">and</font><font color="#000000"> (movingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)]
  </font><font color="#0000aa">let</font><font color="#000000"> _right </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit) </font><font color="#660096">and</font><font color="#000000"> (movingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)]
  </font><font color="#0000aa">let</font><font color="#000000"> _down </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit) </font><font color="#660096">and</font><font color="#000000"> (movingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">)]

  </font><font color="#0000aa">let</font><font color="#000000"> _leftPCT (_left </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit]) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> _upPCT (_up </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit]) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> _rightPCT (_right </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit]) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> _downPCT (_down </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit]) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">
  
  </font><font color="#0000aa">if</font><font color="#000000"> (_leftPCT </font><font color="#660096">&gt;</font><font color="#000000"> Y) [</font><font color="#0000aa">set</font><font color="#000000"> UnitMovingDir </font><font color="#963700">0</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (_upPCT </font><font color="#660096">&gt;</font><font color="#000000"> Y) [</font><font color="#0000aa">set</font><font color="#000000"> UnitMovingDir </font><font color="#963700">1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (_rightPCT </font><font color="#660096">&gt;</font><font color="#000000"> Y) [</font><font color="#0000aa">set</font><font color="#000000"> UnitMovingDir </font><font color="#963700">2</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (_downPCT </font><font color="#660096">&gt;</font><font color="#000000"> Y) [</font><font color="#0000aa">set</font><font color="#000000"> UnitMovingDir </font><font color="#963700">3</font><font color="#000000">]  
     
 ]  

</font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">print</font><font color="#000000"> UnitMovingDir]
 
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#5a5a5a">;;;M4.4</font><font color="#000000">
</font><font color="#5a5a5a">;; a method to see if the selected Unit can move in the selected direction</font><font color="#000000">
</font><font color="#5a5a5a">;; FOR A UNIT TO BE ABLE TO MOVE TO A DIRECTION, LOCATIONS TO ALL BRICKS CURRENT LOC. +1 IN THE MOVING DIRECTIONS HAS TO HAVE EITHER THE UNIT ID, OR 0 (EMPTY)</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> canMove
  
  </font><font color="#0000aa">let</font><font color="#000000"> i  </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> unitMemberList []
  </font><font color="#0000aa">set</font><font color="#000000"> canUnitMove </font><font color="#963700">true</font><font color="#000000"> </font><font color="#5a5a5a">;set to true</font><font color="#000000">
  
  </font><font color="#0000aa">let</font><font color="#000000"> moveRowDiff  </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> moveColDiff  </font><font color="#963700">0</font><font color="#000000">
  
  </font><font color="#5a5a5a">;interpret UnitMovingDir</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveColDiff </font><font color="#963700">-1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveRowDiff </font><font color="#963700">1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveColDiff </font><font color="#963700">1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveRowDiff </font><font color="#963700">-1</font><font color="#000000">]
  
  
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit] [</font><font color="#0000aa">set</font><font color="#000000"> unitMemberList </font><font color="#660096">lput</font><font color="#000000"> patchID unitMemberList] </font><font color="#5a5a5a">;making a list of all the members in the actual Unit</font><font color="#000000">
  

  </font><font color="#5a5a5a">; while: If reporter reports false, exit the loop. Otherwise run commands and repeat. </font><font color="#000000">
  </font><font color="#0000aa">while</font><font color="#000000"> [(i </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">length</font><font color="#000000"> unitMemberList)] </font><font color="#5a5a5a">; loop ends if all members report true, or one member reports false</font><font color="#000000">
  [
    </font><font color="#5a5a5a">;check for world boundaries</font><font color="#000000">
    </font><font color="#5a5a5a">;*ask patches with [patchID = item i unitMemberList] [ if ( ((pxcor + moveColDiff) &lt; -16) or ((pxcor + moveColDiff) &gt; 16) or ((pycor + moveRowDiff) &lt; -16) or ((pycor + moveRowDiff) &gt; 16)) [set canUnitMove false]]</font><font color="#000000">
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [patchID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> i unitMemberList] [ </font><font color="#0000aa">if</font><font color="#000000"> ((((</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveColDiff) </font><font color="#660096">&lt;</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> WorldColCount)) </font><font color="#660096">or</font><font color="#000000">((</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveColDiff) </font><font color="#660096">&gt;</font><font color="#000000"> (WorldColCount))) </font><font color="#660096">or</font><font color="#000000"> (((</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveRowDiff) </font><font color="#660096">&lt;</font><font color="#000000"> (</font><font color="#660096">-</font><font color="#000000"> WorldRowCount)) </font><font color="#660096">or</font><font color="#000000">((</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveRowDiff) </font><font color="#660096">&gt;</font><font color="#000000"> (WorldRowCount)))) [</font><font color="#0000aa">set</font><font color="#000000"> canUnitMove </font><font color="#963700">false</font><font color="#000000">]]

    
    
    </font><font color="#0000aa">if</font><font color="#000000"> (canUnitMove </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">)
    [
    </font><font color="#5a5a5a">;check for otherwise ok movement (other Units can be in the way)</font><font color="#000000">
    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [patchID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> i unitMemberList] [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"> </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveColDiff) (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveRowDiff) [ </font><font color="#0000aa">ifelse</font><font color="#000000">((groupID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)</font><font color="#660096">or</font><font color="#000000">(groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit)) [] [</font><font color="#0000aa">set</font><font color="#000000"> canUnitMove </font><font color="#963700">false</font><font color="#000000">]]]    
    ]
    
    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    

  ]
  
  </font><font color="#5a5a5a">;for DEBUGGING</font><font color="#000000">
 </font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">ifelse</font><font color="#000000"> (canUnitMove </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">)[</font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;can't go =(&quot;</font><font color="#000000">][ </font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;off we goooo =D&quot;</font><font color="#000000">]]
  
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">;;;M4.5</font><font color="#000000">
</font><font color="#5a5a5a">;; a method to physically move the selected unit, if the movement is AUTOHISED by &quot;canMove&quot; method</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> doMove
  
  </font><font color="#0000aa">let</font><font color="#000000"> i  </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> unitMemberList []

  
  </font><font color="#0000aa">let</font><font color="#000000"> moveRowDiff  </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> moveColDiff  </font><font color="#963700">0</font><font color="#000000">
  
  </font><font color="#5a5a5a">;interpret UnitMovingDir</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveColDiff </font><font color="#963700">-1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveRowDiff </font><font color="#963700">1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveColDiff </font><font color="#963700">1</font><font color="#000000">]
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitMovingDir </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> moveRowDiff </font><font color="#963700">-1</font><font color="#000000">]
  
  
  
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [groupID </font><font color="#660096">=</font><font color="#000000"> selectedUnit] [</font><font color="#0000aa">set</font><font color="#000000"> groupID </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patch</font><font color="#000000"> (</font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveColDiff) (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> moveRowDiff) [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">]]
  
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> BrickColor </font><font color="#0000aa">set</font><font color="#000000"> groupID selectedUnit </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> groupID]
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(groupID </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000">)] [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> BGColor </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">plabel</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">]
  
  </font><font color="#0000aa">set</font><font color="#000000">  UnitMoveCounter UnitMoveCounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  
  </font><font color="#0000aa">tick</font><font color="#000000">
  
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">;;;M4</font><font color="#000000">
</font><font color="#5a5a5a">;; a method to tie together the 5 methods: pickOneUnit, decideIfMoving, decideUnitMovingDirection ,canMove ,doMove</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> moveUnit
  
</font><font color="#0000aa">set</font><font color="#000000"> TurnCounter TurnCounter </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">

clearValidMovesList

</font><font color="#0000aa">let</font><font color="#000000"> exitloop </font><font color="#963700">false</font><font color="#000000">

  </font><font color="#5a5a5a">;pick a random unit</font><font color="#000000">
  pickOneUnit
   
   </font><font color="#5a5a5a">;wait 2</font><font color="#000000">
   
  </font><font color="#5a5a5a">;see if they want to move</font><font color="#000000">
  decideIfMoving
  
  </font><font color="#0000aa">if</font><font color="#000000"> (UnitWantsMove </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">)
  [
   
    
    </font><font color="#0000aa">while</font><font color="#000000"> [exitloop </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">false</font><font color="#000000">]
    [
      
      </font><font color="#5a5a5a">;vote for a direction</font><font color="#000000">
      decideUnitMovingDirection
      
      </font><font color="#5a5a5a">;see if it's a valid move</font><font color="#000000">
      canMove
      
      </font><font color="#0000aa">ifelse</font><font color="#000000"> (canUnitMove </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">true</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> exitloop </font><font color="#963700">true</font><font color="#000000">] [ </font><font color="#0000aa">set</font><font color="#000000"> validMovesList </font><font color="#660096">remove</font><font color="#000000"> UnitMovingDir validMovesList ]  
      </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> validMovesList </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [</font><font color="#0000aa">if</font><font color="#000000"> (DebugMSG) [</font><font color="#0000aa">print</font><font color="#000000"> </font><font color="#963700">&quot;NO VALID MOVE !!!!!!&quot;</font><font color="#000000">]  </font><font color="#0000aa">set</font><font color="#000000"> exitloop </font><font color="#963700">true</font><font color="#000000">]
      
    ]
    
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> validMovesList </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)
    [
      </font><font color="#5a5a5a">;move there</font><font color="#000000">
      doMove
    ]
    
  ]
  
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">;;;M4.6</font><font color="#000000">
</font><font color="#5a5a5a">;; a method to reset the validMovesList</font><font color="#000000">
</font><font color="#5a5a5a">;-----------------------------------------------------------------------------------------</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> clearValidMovesList
  
  </font><font color="#5a5a5a">;clear validlist</font><font color="#000000">
  </font><font color="#0000aa">while</font><font color="#000000"> [(</font><font color="#660096">length</font><font color="#000000"> validMovesList) </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">]
  [
    </font><font color="#0000aa">set</font><font color="#000000"> validMovesList </font><font color="#660096">remove-item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList  
  ]
  
  </font><font color="#5a5a5a">;refill it</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> validMovesList </font><font color="#660096">fput</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> validMovesList
  </font><font color="#0000aa">set</font><font color="#000000"> validMovesList </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> validMovesList
  </font><font color="#0000aa">set</font><font color="#000000"> validMovesList </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> validMovesList
  </font><font color="#0000aa">set</font><font color="#000000"> validMovesList </font><font color="#660096">lput</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> validMovesList

  
</font><font color="#007f69">end</font>
</pre>

</body>
</html>
